<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.5.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Runhan Yu">

  
  
  
    
  
  <meta name="description" content="I am currently (still) seeking a job in data/software engineering area, and I am preparing for all kinds of technical interviews, ranging from coding, algorithm, system design, SQL to computer science fundamental quiz. Data engineer is a role with vague definition, and people with this title functions as an ETL (extract, transformation, load) engineer in some companies. Thus, topics on data transformation could be covered during the interview. In this blog, I am trying to hack interview focusing on data tranformation.">

  
  <link rel="alternate" hreflang="en-us" href="/post/448.html/">

  


  
  
  
  <meta name="theme-color" content="hsl(339, 90%, 68%)">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/github.min.css" crossorigin="anonymous" title="hl-light" disabled>
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark">
        
      
    

    

    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro%7CLora:400,700%7CSource+Serif+Pro:400,700&display=swap">
  

  
  
  
  <link rel="stylesheet" href="/css/academic.min.0f85ba7fbbc5cb3fb542dedcf1980ac0.css">

  

  
  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/post/448.html/">

  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="RUNHAN YU">
  <meta property="og:url" content="/post/448.html/">
  <meta property="og:title" content="Hacking the Data Transformation Interview | RUNHAN YU">
  <meta property="og:description" content="I am currently (still) seeking a job in data/software engineering area, and I am preparing for all kinds of technical interviews, ranging from coding, algorithm, system design, SQL to computer science fundamental quiz. Data engineer is a role with vague definition, and people with this title functions as an ETL (extract, transformation, load) engineer in some companies. Thus, topics on data transformation could be covered during the interview. In this blog, I am trying to hack interview focusing on data tranformation."><meta property="og:image" content="/img/icon-192.png">
  <meta property="twitter:image" content="/img/icon-192.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2019-08-30T11:14:00-04:00">
    
    <meta property="article:modified_time" content="2019-09-19T00:54:05-04:00">
  

  


    






  






<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/post/448.html/"
  },
  "headline": "Hacking the Data Transformation Interview",
  
  "datePublished": "2019-08-30T11:14:00-04:00",
  "dateModified": "2019-09-19T00:54:05-04:00",
  
  "author": {
    "@type": "Person",
    "name": "Runhan Yu"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "RUNHAN YU",
    "logo": {
      "@type": "ImageObject",
      "url": "/img/icon-512.png"
    }
  },
  "description": "\u003cp\u003eI am currently (still) seeking a job in data/software engineering area, and I am preparing for all kinds of technical interviews, ranging from coding, algorithm, system design, SQL to computer science fundamental quiz. Data engineer is a role with vague definition, and people with this title functions as an ETL (extract, transformation, load) engineer in some companies. Thus, topics on data transformation could be covered during the interview. In this blog, I am trying to hack interview focusing on data tranformation.\u003c/p\u003e"
}
</script>

  

  


  


  





  <title>Hacking the Data Transformation Interview | RUNHAN YU</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="dark">

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0 compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/">RUNHAN YU</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav mr-auto">
        

        

        
        
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link  active" href="/"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link  active" href="/post"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/project"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/publication"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/tags"><span>Tag</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/files/Runhan-Yu.pdf"><span>CV</span></a>
        </li>

        
        

      
      </ul>
      <ul class="navbar-nav ml-auto">
      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        
        <li class="nav-item">
          <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
        </li>
        

      </ul>

    </div>
  </div>
</nav>


  <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>Hacking the Data Transformation Interview</h1>

  

  
    



<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
          Last updated on
      
    
    Sep 19, 2019
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    3 min read
  </span>
  

  
  
  

  
  

  
    
<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/post/448.html/&amp;text=Hacking%20the%20Data%20Transformation%20Interview" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/post/448.html/&amp;t=Hacking%20the%20Data%20Transformation%20Interview" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook-f"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Hacking%20the%20Data%20Transformation%20Interview&amp;body=/post/448.html/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/post/448.html/&amp;title=Hacking%20the%20Data%20Transformation%20Interview" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=Hacking%20the%20Data%20Transformation%20Interview%20/post/448.html/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=/post/448.html/&amp;title=Hacking%20the%20Data%20Transformation%20Interview" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>


  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style">
      <p>I am currently (still) seeking a job in data/software engineering area, and I am preparing for all kinds of technical interviews, ranging from coding, algorithm, system design, SQL to computer science fundamental quiz. Data engineer is a role with vague definition, and people with this title functions as an ETL (extract, transformation, load) engineer in some companies. Thus, topics on data transformation could be covered during the interview. In this blog, I am trying to hack interview focusing on data tranformation.</p>

<h2 id="prerequisites-boto3">Prerequisites: boto3</h2>

<p>Boto is the AWS SDK for python, which provides easy-to-use, object-oriented API and low-level access to AWS services. We could find the documentation <a href="https://boto3.amazonaws.com/v1/documentation/api/latest/index.html" target="_blank">here</a>.</p>

<p>We could easily install the latest Boto 3 release via pip:</p>

<pre><code class="language-shell">$ pip install boto3
</code></pre>

<p>Then configure the credential file at <code>~/.aws/credentials</code>:</p>

<pre><code class="language-nil">[default]
aws_access_key_id = YOUR_ACCESS_KEY
aws_secret_access_key = YOUR_SECRET_KEY
</code></pre>

<p>And set the default region at <code>~/.aws/config</code>:</p>

<pre><code class="language-nil">[default]
region=us-east-1
</code></pre>

<p>To use boto3, we could import it and pass the service-to-use to it. For example, to use Amazon S3, we could choose a resource by:</p>

<pre><code class="language-python">import boto3
s3 = boto3.resource('s3')
</code></pre>

<p>Create a s3 bucket over client level:</p>

<pre><code class="language-python">s3_client = boto3.client('s3')
s3_client.create_bucket(Bucket='BUCKET_NAME')
</code></pre>

<p>List existing buckets for the AWS account:</p>

<pre><code class="language-python">response = s3_client.list_buckets()
for bucket in response['Buckets']:
    print(f'  {bucket[&quot;Name&quot;]}')
</code></pre>

<p>Upload file into a s3 bucket:</p>

<pre><code class="language-python">response = s3_client.upload_file(file_name, bucket, object_name)
</code></pre>

<p>Or upload object in binary mode into a s3 bucket:</p>

<pre><code class="language-python">with open('test.jpg', 'rb') as f:
    s3.upload_fileobj(f, &quot;BUCKET_NAME&quot;, &quot;OBJECT_NAME&quot;)
</code></pre>

<p>Or directly put object into a s3 bucket over the bucket level:</p>

<pre><code class="language-python">data = open('test.jpg', 'rb')
bucket = s3.Bucket('my-bucket')
bucket.put_object(Key=object_name, Body=data)
</code></pre>

<p>To download file from a S3 bucket, we could:</p>

<pre><code class="language-python">s3.download_file('BUCKET_NAME', 'OBJECT_NAME', 'FILE_NAME')
</code></pre>

<p>Or:</p>

<pre><code class="language-python">with open('FILE_NAME', 'wb') as f:
    s3.download_fileobj('BUCKET_NAME', 'OBJECT_NAME', f)
</code></pre>

<p>We could also set configuration when uploading, downloading, or copying a file or S3 object by:</p>

<pre><code class="language-python">from boto3.s3.transfer import TransferConfig
GB = 1024 ** 3
config = TransferConfig(multipart_threshold=5*GB)
config = TransferConfig(max_concurrency=5)
config = TransferConfig(use_threads=False)
s3.upload_file('FILE_NAME', 'BUCKET_NAME', 'OBJECT_NAME', Config=config)
</code></pre>

<h2 id="prerequisites-psycopg2">Prerequisites: psycopg2</h2>

<p>Psycopg2 is a popular PostgreSQL database adapter for python. We could find documentation <a href="http://initd.org/psycopg/docs/" target="_blank">here</a>.</p>

<p>We could easily install psycopg2 via pip:</p>

<pre><code class="language-shell">$ pip install psycopg2-binary
</code></pre>

<p>To use psycopg2, we could import it, connect to an existing database and open a cursor to perform database operations:</p>

<pre><code class="language-python">import psycopg2
conn = psycopg2.connect(dbname=&quot;DATABASE_NAME&quot;, user=&quot;USER&quot;, host=&quot;HOST&quot;, port=&quot;PORT&quot;, password=&quot;PASSWORD&quot;)
cur = conn.cursor()
</code></pre>

<p>Query the database and fetch data in an iteration-like way:</p>

<pre><code class="language-python">cur.execute(sql_query)
cur.fetchone()
cur.fetchmany(2)
cur.fetchall()
</code></pre>

<p>Pass parameters to SQL queries:</p>

<pre><code class="language-python">cur.execute(&quot;&quot;&quot;
    INSERT INTO some_table (an_int, a_date, another_date, a_string)
    VALUES (%(int)s, %(date)s, %(date)s, %(str)s);
    &quot;&quot;&quot;,
    {'int': 10, 'str': &quot;O'Reilly&quot;, 'date': datetime.date(2005, 11, 18)})
</code></pre>

<p>Make the changes to the database persistent:</p>

<pre><code class="language-python">conn.commit()
</code></pre>

<p>Close communication with the database</p>

<pre><code class="language-python">cur.close()
conn.close()
</code></pre>

<h2 id="upload-data-from-s3-into-redshift">Upload data from S3 into Redshift</h2>

<pre><code class="language-python">def main():
    connection_parameters = {
        'dbname': dbname,
        'user': user,
        'host': host,
        'port': port,
        'password': password
    }
    try:
        conn = psycopg2.connect(**connection_parameters)
        print(&quot;Connected to Redshift.&quot;)
    except:
        print(&quot;Unable to connect to Redshift.&quot;)

    cur = conn.cursor()

    upload_statement = &quot;
            COPY {}.{}
            FROM {}
            IAM_ROLE {}
            CSV;
            COMMIT;
    &quot;.format(table_name, schema, file_name, iam_role)

    try:
        cur.execute(upload_statement)
        print(&quot;Upload successfully&quot;)
    except psycopg2.Error:
        raise ExecuteFailure(&quot;Failed to upload the file.&quot;)
    cur.close()
    conn.close()

if __name__ == &quot;__main__&quot;:
    main()
</code></pre>

<h2 id="load-data-from-redshift-to-pandas">Load data from Redshift to pandas</h2>

<pre><code class="language-python">import sqlalchemy as sa
import pandas as pd
surl = 'redshift+psycopg2://'
engine = sa.create_engine(surl+user+':'+password+'@'+host+':'+port+'/'+dbname,echo=False)
df = pd.read_sql_query('SELECT * FROM table ;', engine)
</code></pre>
    </div>

    


    

<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/data-engineering/">Data-Engineering</a>
  
  <a class="badge badge-light" href="/tags/interview/">Interview</a>
  
  <a class="badge badge-light" href="/tags/python/">Python</a>
  
</div>



    
      








  






  
  
  
    
  
  
  <div class="media author-card">
    
      
      <img class="portrait mr-3" src="/authors/admin/avatar_hu3e0731a94ec188ce0fdbaf6959b64cdd_33225_250x250_fill_q90_lanczos_center.jpeg" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title"><a href="/">Runhan Yu</a></h5>
      <h6 class="card-subtitle">Data Engineer</h6>
      <p class="card-text">My interests include big data, cloud computing, software development and biochemistry.</p>
      <ul class="network-icon" aria-hidden="true">
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a href="https://github.com/ziyunch" target="_blank" rel="noopener">
              <i class="fab fa-github"></i>
            </a>
          </li>
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a href="https://www.linkedin.com/in/runhanyu/" target="_blank" rel="noopener">
              <i class="fab fa-linkedin"></i>
            </a>
          </li>
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a href="/#contact" >
              <i class="fas fa-envelope"></i>
            </a>
          </li>
        
          
          
          
          
          
          
          
            
          
          <li>
            <a href="https://scholar.google.com/citations?user=iuNw-9YAAAAJ" target="_blank" rel="noopener">
              <i class="ai ai-google-scholar"></i>
            </a>
          </li>
        
          
          
          
          
          
          
          
            
          
          <li>
            <a href="/files/Runhan-Yu.pdf" >
              <i class="ai ai-cv"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>



      
      
      <div class="article-widget">
        <div class="hr-light"></div>
        <h3>Related</h3>
        <ul>
          
          <li><a href="/post/444.html/">Plain text accounting tool Beancount in Emacs</a></li>
          
          <li><a href="/project/rxminer/">RxMiner</a></li>
          
          <li><a href="/project/gistic/">Gene Variation Analysis of Stomach Cancer</a></li>
          
          <li><a href="/project/csv2bean/">CSV2Bean</a></li>
          
          <li><a href="/project/multicrawler/">Multithread Web Crawler</a></li>
          
        </ul>
      </div>
      
    

    

    


  </div>
</article>

      

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js" integrity="sha256-aYTdUrn6Ow1DDgh5JTc3aDGnnju48y/1c8s1dgkYPQ8=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/r.min.js"></script>
        
      

      
      
    

    
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script>
      const search_index_filename = "/index.json";
      const i18n = {
        'placeholder': "Search...",
        'results': "results found",
        'no_results': "No results found"
      };
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.130521ecfc6f534c52c158217bbff718.js"></script>

    






  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" id="back_to_top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
